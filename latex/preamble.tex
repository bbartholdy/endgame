\usepackage{booktabs}
\usepackage{emptypage}
\usepackage{amsthm}
\makeatletter
\def\thm@space@setup{%
  \thm@preskip=8pt plus 2pt minus 4pt
  \thm@postskip=\thm@preskip
}
\makeatother


\makeatletter
\def\cleardoublepage{\clearpage\if@twoside \ifodd\c@page\else
\begingroup
\mbox{}
\vspace*{\fill}
\begin{center}
\textit{This page is unintentionally left blank.}
\end{center}
\vspace{\fill}
\thispagestyle{empty}
\newpage
\if@twocolumn\mbox{}\newpage\fi
\endgroup\fi\fi}
\makeatother


%% Chapter formatting


%\def\fourtytwo{"All right," said Deep Thought. "The Answer to the Great Question..."\\
%"Yes..!"\\
%"Of Life, the Universe and Everything..." said Deep Thought.\\
%"Yes...!"\\
%"Is..." said Deep Thought, and paused.\\
%"Yes...!"\\
%"Is..."\\
%"Yes...!!!...?"\\
%"Forty-two," said Deep Thought, with infinite majesty and calm.}
\def\fourtytwo{"How many roads must a man walk down?"}
\usepackage{fancyhdr}
\pagestyle{fancy}
\fancyhf{} % clear existing header/footer entries
% Place Page X of Y on the right-hand
% side of the footer
%\fancyhead[LE]{\ifnum\value{page} = 42
  %\huge\bfseries{\thepage}\else\thepage\fi}
%\fancyhead[LE]{\ifnum\value{page} = 42
%  \footnotesize\bfseries{\fourtytwo}\else\thepage\fi}
%\fancyfoot[L]{\ifnum\value{page} = 42
%\scriptsize\fourtytwo\fi}
\fancyhead[LE]{\ifnum\value{page} = 42
\textit\fourtytwo\else\thepage\enspace\MakeLowercase{\textsl{\leftmark}}\fi}
\fancyhead[RO]{\MakeLowercase{\textsl{\rightmark}}\enspace\thepage}
\renewcommand{\headrulewidth}{0pt}
\renewcommand{\footrulewidth}{0pt}

\usepackage{titlesec, blindtext, color} % titlesec needs `pandoc --variable subparagraph` to work
\definecolor{gray75}{gray}{0.75}
\newcommand{\hsp}{\hspace{20pt}}
\titleformat{\chapter}[hang]{\Huge\bfseries}{\thechapter\hsp\textcolor{gray75}{|}\hsp}{0pt}{\Huge\bfseries}

% chapter and section names in header
%\renewcommand{\chaptermark}[1]{\markboth{\MakeLowercase{\chaptername\_\thechapter\ <-\ #1}}{}}
%\renewcommand{\chaptermark}[1]{\markboth{\MakeLowercase{\chaptername\_\thechapter\ <-\ #1}}{}}
\renewcommand{\chaptermark}[1]{\markboth{\MakeLowercase{#1}}{}}
\renewcommand{\chaptermark}[1]{\markboth{\MakeLowercase{#1}}{}}
\renewcommand{\sectionmark}[1]{\markright{\MakeLowercase{#1}}{} }

% fix header names for toc, lof, and lot to match chapter and section names
\usepackage{etoolbox}
\patchcmd{\tableofcontents}{\MakeUppercase\contentsname}{\MakeLowercase\contentsname}{}{} 
\patchcmd{\tableofcontents}{\MakeUppercase\contentsname}{\MakeLowercase\contentsname}{}{} % twice to remove on both sides of header
\patchcmd{\listoffigures}{\MakeUppercase\listfigurename}{\MakeLowercase\listfigurename}{}{}
\patchcmd{\listoffigures}{\MakeUppercase\listfigurename}{\MakeLowercase\listfigurename}{}{} % twice to remove on both sides of header
\patchcmd{\listoftables}{\MakeUppercase\listtablename}{\MakeLowercase\listtablename}{}{}
\patchcmd{\listoftables}{\MakeUppercase\listtablename}{\MakeLowercase\listtablename}{}{} % twice to remove on both sides of header


% modify captions for figures and tables
\usepackage[labelfont=bf,
    labelsep=endash,
    singlelinecheck=off,
    format=plain,
    margin=1.2cm,
    aboveskip=12pt,
    belowskip=12pt,
    font={footnotesize,stretch=1},
    justification=justified]{caption}

% make table font smaller
\BeforeBeginEnvironment{longtable}{\begin{center}\footnotesize}
\AfterEndEnvironment{longtable}{\end{center}}

\raggedbottom
\sloppy